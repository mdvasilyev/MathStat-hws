\documentclass{assignment}


\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{fullpage}
\usepackage{listings}
\usepackage{color}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{qtree}
% \usepackage{minted}
\usepackage{tikz}
\usepackage[export]{adjustbox}
\usepackage{booktabs,makecell}
\usepackage{diagbox}

\usepackage[unicode=true, colorlinks=true, linkcolor=blue, urlcolor=blue]{hyperref} 

\begin{document}

\assignmentTitle{Васильев М.Д. ИТМО}{M4140}{assets/mse_logo.png}{Домашнее задание 3}

\section*{Теоритическая часть}
\begin{enumerate}
    \item \textbf{(2 балла)} Найти оценки методом максимального правдоподобия параметра $\theta > 0$, если распределение выборки имеет плотность:
    \begin{itemize}
        \item $\theta t^{\theta - 1}, \quad t \in [0, 1]$
        \start
        \begin{align*}
            &L = \prod_{i=1}^{n} \theta t_i^{\theta - 1} = \theta^n \prod_{i=1}^{n} t_i^{\theta - 1} \\
            &\ln L = \ln (\theta^n \prod_{i=1}^{n} t_i^{\theta - 1}) = \ln \theta^n + \ln (\prod_{i=1}^{n} t_i^{\theta - 1}) = n \ln \theta + \sum_{i=1}^{n} \ln (t_i^{\theta - 1}) = \\
            &n \ln \theta + (\theta - 1)\sum_{i=1}^{n} \ln (t_i) \\
            &0 = \frac{\partial}{\partial \theta}\ln L = \frac{\partial}{\partial \theta}(n \ln \theta + (\theta - 1)\sum_{i=1}^{n} \ln (t_i)) = \frac{n}{\theta} + \sum_{i=1}^{n}\ln (t_i) \\
            &\frac{n}{\hat{\theta}} = -\sum_{i=1}^{n}\ln (t_i) \\
            & \hat{\theta} = - \frac{n}{\sum_{i=1}^{n}\ln (t_i)}
        \end{align*}
        \finish
        \item $\displaystyle \frac{2t}{\theta^2},\quad \quad  t \in [0, \theta]$
        \start
        \begin{align*}
            &L = \prod_{i=1}^{n} \frac{2t_i}{\theta^2} = \frac{2^n}{\theta^{2n}} \prod_{i=1}^{n} t_i \\
            &\ln L = \ln (\frac{2^n}{\theta^{2n}} \prod_{i=1}^{n} t_i) = \ln \frac{2^n}{\theta^{2n}} + \ln (\prod_{i=1}^{n} t_i) = n \ln 2 - 2n \ln \theta + \sum_{i=1}^{n} \ln (t_i) \\
            &0 = \frac{\partial}{\partial \theta}\ln L = \frac{\partial}{\partial \theta}(n\ln 2 - 2n \ln \theta + \sum_{i=1}^{n} \ln (t_i)) = -\frac{2n}{\theta} \\
            &\frac{2n}{\hat{\theta}} = 0 \\
            &\hat{\theta} = \max (t_i) = \theta
        \end{align*}
        \finish
        \item $\displaystyle \frac{\theta e^{\frac{-\theta^2}{2t}}}{\sqrt{2 \pi t^3}}, \quad t > 0$
        \start
        \begin{align*}
            &L = \prod_{i=1}^{n} \frac{\theta e^{\frac{-\theta^2}{2t_i}}}{\sqrt{2 \pi t_i^3}} = \frac{\theta^n}{(\sqrt{2\pi})^n} \prod_{i=1}^{n} \frac{e^{\frac{-\theta^2}{2t_i}}}{\sqrt{t_i^3}} \\
            &\ln L = \ln (\frac{\theta^n}{(\sqrt{2\pi})^n} \prod_{i=1}^{n} \frac{e^{\frac{-\theta^2}{2t_i}}}{\sqrt{t_i^3}}) = \ln \frac{\theta^n}{(\sqrt{2\pi})^n} + \ln (\prod_{i=1}^{n} \frac{e^{\frac{-\theta^2}{2t_i}}}{\sqrt{t_i^3}}) = n\ln\theta - n\ln\sqrt{2\pi} + \\
            &+\sum_{i=1}^{n} \ln(\frac{e^{\frac{-\theta^2}{2t_i}}}{\sqrt{t_i^3}}) = n\ln\theta - n\ln\sqrt{2\pi} + \sum_{i=1}^{n} (\frac{-\theta^2}{2t_i} - \ln (\sqrt{t_i^3})) \\
            &0 = \frac{\partial}{\partial \theta}\ln L = \frac{\partial}{\partial \theta}(n\ln\theta - n\ln\sqrt{2\pi} + \sum_{i=1}^{n} (\frac{-\theta^2}{2t_i} - \ln (\sqrt{t_i^3}))) = \frac{n}{\theta} -2\theta \sum_{i=1}^{n} (\frac{1}{2t_i}) \\
            &\frac{n}{\hat{\theta}} -2\hat{\theta} \sum_{i=1}^{n} (\frac{1}{2t_i}) = 0 \\
            &n -2\hat{\theta}^2 \sum_{i=1}^{n} (\frac{1}{2t_i}) = 0 \\
            &\hat{\theta} = \sqrt{\frac{n}{2\sum_{i=1}^{n} (\frac{1}{2t_i})}}
        \end{align*}
        \finish
        \item $\displaystyle \frac{\theta (\ln{t})^{\theta - 1}}{t}, \quad t \in [1, e]$
        \start
        \begin{align*}
            &L = \prod_{i=1}^{n} \frac{\theta (\ln{t_i})^{\theta - 1}}{t_i} = \theta^n \prod_{i=1}^{n} \frac{(\ln{t_i})^{\theta - 1}}{t_i} \\
            &\ln L = \ln (\theta^n \prod_{i=1}^{n} \frac{(\ln{t_i})^{\theta - 1}}{t_i}) = \ln \theta^n + \ln (\prod_{i=1}^{n} \frac{(\ln{t_i})^{\theta - 1}}{t_i}) = n\ln\theta + \sum_{i=1}^{n} \ln(\frac{(\ln{t_i})^{\theta - 1}}{t_i}) = \\
            &n\ln\theta + \sum_{i=1}^{n} (\ln(\ln{t_i})^{\theta - 1} - \ln t_i) = n\ln\theta + \sum_{i=1}^{n} ((\theta - 1)\ln(\ln{t_i}) - \ln t_i) \\
            &0 = \frac{\partial}{\partial \theta}\ln L = \frac{\partial}{\partial \theta}(n\ln\theta + \sum_{i=1}^{n} ((\theta - 1)\ln(\ln{t_i}) - \ln t_i)) = \frac{n}{\theta} + \sum_{i=1}^{n} \ln(\ln{t_i}) \\
            &\frac{n}{\hat{\theta}} + \sum_{i=1}^{n} \ln(\ln{t_i}) = 0 \\
            &\hat{\theta} = -\frac{n}{\sum_{i=1}^{n} \ln(\ln{t_i})}
        \end{align*}
        \finish
    \end{itemize}

    \item \textbf{(2 балла)} Пусть выборка $X_1, \ldots, X_n$ из  распределения Коши с параметром $\gamma$. 
    Плотность задается следующим образом:
    $$
    p_{\gamma}(x) = \frac{1}{\pi \big(1 + (x - \gamma)^2\big)}
    $$

    Существует ли оценка методом максимального правдоподобия для параметра $\gamma$ в общем случае? Поясните.

    Попробуйте найти оценку ММП по выборке из двух наблюдений: $X_1 = -2, X_2 = 2$.
    \start
    В общем случае оценки методом максимального правдободобия не существует, потому что у распределения Коши нет конечного математического ожидания и дисперсии, поэтому такая оценка можнт быть несостоятельной.

    Попробуем найти оценку ММП для данной выборки:
    \begin{align*}
        &L = \prod_{i=1}^{2} \frac{1}{\pi \big(1 + (x_i - \gamma)^2\big)} = \frac{1}{\pi^2 \big(1 + (x_1 - \gamma)^2\big)\big(1 + (x_2 - \gamma)^2\big)} \\
        &\ln L = \ln (\frac{1}{\pi^2 \big(1 + (x_1 - \gamma)^2\big)\big(1 + (x_2 - \gamma)^2\big)}) = - 2\ln\pi - \ln \big(1 + (x_1 - \gamma)^2\big) - \ln \big(1 + (x_2 - \gamma)^2\big) \\
        &0 = \frac{\partial}{\partial \gamma} L = \frac{\partial}{\partial \gamma} (- 2\ln\pi - \ln \big(1 + (x_1 - \gamma)^2\big) - \ln \big(1 + (x_2 - \gamma)^2\big)) = \\
        &\frac{2(x_1 - \gamma)}{1 + (x_1 - \gamma)^2} + \frac{2(x_2 - \gamma)}{1 + (x_2 - \gamma)^2} = \frac{2(-2 - \gamma)}{1 + (-2 - \gamma)^2} + \frac{2(2 - \gamma)}{1 + (2 - \gamma)^2} \\
        &\underline{\hat{\gamma} = 0}
    \end{align*}
    \finish
\end{enumerate}
    
\end{document}
